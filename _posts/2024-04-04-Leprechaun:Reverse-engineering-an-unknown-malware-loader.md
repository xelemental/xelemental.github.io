---
title:  "Leprechaun: Reverse-engineering an unknown malware loader"
layout: post
categories: reverse-engineering
---



## Table Of Contents


- Background.
- Metadata.
- Overview of the implant.
- Reverse Engineering the loader using IDA-Freeware-I.
- Reverse Engineering the loader using IDA-Freeware-II.
- Features of the loader.
- Limitations.
- Author's two cents.
- Resources.  



## Background

In the past month of April 2024, I have been swamped with a lot of work, well, fortunately, now in May, I have an ample amount of time to publish a few blogs, which I plan to and the first and a small one which, now am writing is about this malware loader known as `LeprechaunHvnc`. While browsing Twitter, I recently stumbled upon a tweet by a fellow malware researcher [Kseniia N](https://twitter.com/naumovax), about an [unknown loader](https://x.com/naumovax/status/1775185431237206209) which was discovered by Kseniia & another well-known researcher [Tony](https://twitter.com/t0nynot) from Positive Technology. 

So, this blog will contain my approach to reverse-engineer this malware loader and explain it from a layman's perspective.  We can get started without any further delay. 



## Metadata


SHA-256 : `1d0753beaabc660960bb5297f43eae38128647c2a23b02b2550646d58aff8797`

Sample: Available [here.](https://bazaar.abuse.ch/sample/1d0753beaabc660960bb5297f43eae38128647c2a23b02b2550646d58aff8797#)



## Overview of the implant. 

![Credits : CryptoInsane](https://github.com/xelemental/xelemental.github.io/assets/49472311/c44a6b7e-de8b-4e58-9892-7e499210d468)


As the post said, the malware loader is currently new in the wild, with very limited features of `installbot` which is responsible for installing the second-stager, `fetch-command` which is supposedly responsible for fetching commands from the threat actor for actions to perform on the target host and the `updateCommand` which is responsible for updating the tasks done and similar functionalities. The C2 for this loader was hosted at `65[.]20[.]106[.]109:80`. Well, last but not least is this loader based on an Irish mythical character. 
